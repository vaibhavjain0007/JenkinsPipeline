pipeline {
    agent any
    // Parameter for branch selection with a dropdown list of branches
        choice(name: 'BRANCH_NAME', choices: ['main', 'test_branch_first', 'test_branch_second'], description: 'Choose the branch to build')

        // Or you can use a string parameter for manual entry
        // string(name: 'BRANCH_NAME', defaultValue: 'main', description: 'Enter the branch to build')
    stages {
        stage('Checkout') {
            steps {
                script {
                    // Checkout the branch selected from the parameters
                    git branch: params.BRANCH_NAME, url: 'https://github.com/vaibhavjain0007/JenkinsPipeline.git'
                }
            }
        }

        stage('Test Email') {
            steps {
                script {
                    emailext (
                        subject: "Test Email from Jenkins",
                        body: "This is a test email sent from Jenkins.",
                        to: "mfsi.vaibhavj@gmail.com"
                    )
                }
            }
        }
        stage('Build') {
            steps {
                echo 'Building the application...'
            }
        }
        stage('Test') {
            steps {
                echo 'Running the tests...'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying application...'
            }
        }
    }
    post {
        success {
            echo 'Pipeline completed successfully.'
        }
        failure {
            echo 'Pipeline failed.'
            emailext (
              subject: "Jenkins Pipeline Failure",
              body: "The Jenkins pipeline has failed.",
              to: "vaibhav25011998@gmail.com"
            )
        }
        always {
            echo 'This will always run, regardless of success or failure.'
        }
    }
}
